<view class="container">
  <!-- å¤´éƒ¨æ¨ªå¹… -->
  <view class="banner">
    <view class="banner-content">
      <text class="banner-title">ğŸ‚ é›ªæ¿ä»·æ ¼ç›‘æ§</text>
      <text class="banner-desc">å®æ—¶è¿½è¸ªæœ€æ–°é›ªæ¿ä»·æ ¼å’ŒæŠ˜æ‰£</text>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="stats-grid">
    <view class="stat-card">
      <text class="stat-number">{{stats.total}}</text>
      <text class="stat-label">æ€»äº§å“æ•°</text>
    </view>
    <view class="stat-card">
      <text class="stat-number">{{stats.brands}}</text>
      <text class="stat-label">å“ç‰Œæ•°é‡</text>
    </view>
    <view class="stat-card">
      <text class="stat-number">{{stats.lastUpdated.split(' ')[0]}}</text>
      <text class="stat-label">æœ€åæ›´æ–°</text>
    </view>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="filter-section">
    <input 
      placeholder="æœç´¢é›ªæ¿å“ç‰Œæˆ–åç§°..." 
      bindinput="onSearchInput"
      class="search-input"
    />
    
    <view class="filter-controls">
      <picker 
        range="{{['æ‰€æœ‰å“ç‰Œ', 'Burton', 'Lib Tech', 'Salomon', 'K2', 'Capita', 'Ride', 'Rome', 'Never Summer', 'Gnu', 'Arbor', 'Bataleon', 'YES', 'Rossignol', 'Roxy']}}" 
        bindchange="onBrandFilter"
        class="filter-picker"
      >
        <view class="picker-label">
          {{filterBrand || 'æ‰€æœ‰å“ç‰Œ'}}
        </view>
      </picker>
      
      <picker 
        range="{{['æŒ‰åç§°', 'ä»·æ ¼ä»ä½åˆ°é«˜', 'ä»·æ ¼ä»é«˜åˆ°ä½', 'æŒ‰å“ç‰Œ']}}" 
        bindchange="onSortChange"
        class="filter-picker"
      >
        <view class="picker-label">
          {{sortBy === 'name' ? 'æŒ‰åç§°' : sortBy === 'price_low' ? 'ä»·æ ¼ä»ä½åˆ°é«˜' : sortBy === 'price_high' ? 'ä»·æ ¼ä»é«˜åˆ°ä½' : 'æŒ‰å“ç‰Œ'}}
        </view>
      </picker>
    </view>
  </view>

  <!-- äº§å“åˆ—è¡¨ -->
  <view class="product-list">
    <view 
      wx:for="{{displayedProducts}}" 
      wx:key="id" 
      class="product-card"
      bindtap="viewProduct"
      data-product="{{item}}"
    >
      <image 
        src="{{item.image}}" 
        mode="aspectFill" 
        class="product-image"
        binderror="onImageError"
        data-index="{{index}}"
      />
      <view class="product-info">
        <text class="product-brand">{{item.brand}}</text>
        <text class="product-name">{{item.name}}</text>
        <view class="price-section">
          <text class="current-price">{{item.current_price || 'ä»·æ ¼å¾…å®š'}}</text>
          <text wx:if="{{item.original_price}}" class="original-price">{{item.original_price}}</text>
          <text wx:if="{{item.discount}}" class="discount">{{item.discount}}</text>
        </view>
        <text class="category">{{item.category}}</text>
        <view class="action-buttons">
          <button 
            class="copy-btn" 
            bindtap="copyPriceInfo" 
            data-product="{{item}}"
            size="mini"
          >
            å¤åˆ¶ä»·æ ¼
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view wx:if="{{hasMore && !loading}}" class="load-more">
    <button bindtap="loadMore" class="load-more-btn">åŠ è½½æ›´å¤š</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{!loading && displayedProducts.length === 0}}" class="empty">
    <text>æš‚æ— é›ªæ¿æ•°æ®</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
  <view wx:if="{{!hasMore && displayedProducts.length > 0}}" class="no-more">
    <text>å·²æ˜¾ç¤ºå…¨éƒ¨æ•°æ®</text>
  </view>
</view>